version: 0.2.0.{build}
environment:
  nodejs_version: "6"
# Install scripts. (runs after repo cloning)
install:
  # Get the latest stable version of Node.js or io.js
  - ps: Install-Product node $env:nodejs_version
  - ps: Install-PackageProvider Chocolatey
  # install modules
  - npm install
  - choco install gradle
  - choco install maven
  - ps: refreshenv
# Post-install test scripts.
test_script:
  # Output useful info for debugging.
  - node --version
  - npm --version
  - mvn --version
  - npm install -g nyc
  - nyc npm test
  - npm run build-wrappers
  - npm run build-input-project
  - npm install -g gulp
  - gradle --version
  - gulp run-java-tests
  - cd wiki && mvn clean package && java -cp target/Wiki-1.0-SNAPSHOT.jar io.xrails.App && rm -rf compiler.wiki/ && git clone https://github.com/crossrails/compiler.wiki.git && mv wiki.md compiler.wiki/compiler-options.md
# Don't actually build.
build: off
